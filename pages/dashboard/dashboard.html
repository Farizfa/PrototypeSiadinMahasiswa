<!DOCTYPE html>
<html lang="id">

<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>Dashboard - SiAdin Mahasiswa</title>

  <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0/dist/css/bootstrap.min.css" rel="stylesheet" />
  <link href="https://cdn.jsdelivr.net/npm/bootstrap-icons@1.10.0/font/bootstrap-icons.css" rel="stylesheet" />

  <link rel="stylesheet" href="/assets/css/style.css" />
  <link rel="stylesheet" href="/assets/css/dashboard/styleDashboard.css" />
</head>

<body>
  <div class="layout-wrapper">
    <!-- Sidebar Desktop -->
    <div id="sidebar-container" class="sidebar-container"></div>

    <!-- Sidebar Mobile Offcanvas -->
    <div class="offcanvas offcanvas-start d-md-none" tabindex="-1" id="mobileSidebar"
      aria-labelledby="mobileSidebarLabel" style="
          height: 100vh;
          min-height: 100vh;
          width: 250px;
          border-right: 1px solid #dee2e6;
        ">
      <div class="offcanvas-header">
        <h5 id="mobileSidebarLabel" class="mb-0">Menu</h5>
        <button type="button" class="btn-close" data-bs-dismiss="offcanvas" aria-label="Close"></button>
      </div>
      <div class="offcanvas-body p-0">
        <div id="mobile-sidebar-container"></div>
      </div>
    </div>

    <!-- Main Content -->
    <div class="main-content">
      <!-- Header -->
      <div id="header-container" class="header-container"></div>

      <!-- Content -->
      <div class="content-container">
        <div class="dashboard-wrapper">
          <div class="container-fluid">
            <h5 class="fw-bold" style="color: #1e3a8b">
              Selamat siang, Kawaya Simanjuntak
            </h5>
            <p class="text-muted">Kamu punya 2 kelas hari ini!</p>

            <div class="row g-4">
              <div class="col-lg-9">
                <div class="row g-3 mb-4">
                  <div class="col-md-4">
                    <div class="info-card">
                      <i class="bi bi-journal-text"></i>
                      <h5 class="fw-bold mb-0">10</h5>
                      <small class="text-muted">Mata Kuliah</small>
                      <hr class="my-2" />
                      <a href="#" class="small text-muted text-decoration-none">
                        Lihat lebih detail
                        <i class="bi bi-box-arrow-right ms-1"></i>
                      </a>
                    </div>
                  </div>
                  <div class="col-md-4">
                    <div class="info-card">
                      <i class="bi bi-book"></i>
                      <h5 class="fw-bold mb-0">24</h5>
                      <small class="text-muted">SKS</small>
                      <hr class="my-2" />
                      <a href="#" class="small text-muted text-decoration-none">
                        Lihat lebih detail
                        <i class="bi bi-box-arrow-right ms-1"></i>
                      </a>
                    </div>
                  </div>
                  <div class="col-md-4">
                    <div class="info-card">
                      <i class="bi bi-mortarboard"></i>
                      <h5 class="fw-bold mb-0">3.80</h5>
                      <small class="text-muted">IPK</small>
                      <hr class="my-2" />
                      <a href="#" class="small text-muted text-decoration-none">
                        Lihat lebih detail
                        <i class="bi bi-box-arrow-right ms-1"></i>
                      </a>
                    </div>
                  </div>
                </div>

                <div class="row g-4">
                  <div class="col-lg-8">
                    <!-- Jadwal Hari Ini -->
                    <h5 class="fw-semibold text-secondary">Jadwal hari ini</h5>
                    <div class="border rounded p-3 mb-4">
                      <div class="border-top border-end border-bottom rounded p-2 d-flex flex-column" style="
                          border-left: 4px solid #1e3a8b;
                          margin-bottom: 1rem;
                        ">
                        <span class="fw-semibold mb-2">Kerja Praktek</span>
                        <div class="d-flex align-items-center justify-content-between text-muted"
                          style="font-size: 0.875rem">
                          <span><i class="bi bi-clock me-1"></i>08.40 - 10.00</span>
                          <span><i class="bi bi-geo-alt me-1"></i>Kulino</span>
                        </div>
                      </div>
                      <div class="border-top border-end border-bottom rounded p-2 mb-3"
                        style="border-left: 4px solid #1e3a8b">
                        <span class="fw-semibold mb-2">Metodologi Penelitian</span>
                        <div class="d-flex align-items-center justify-content-between text-muted"
                          style="font-size: 0.875rem">
                          <span><i class="bi bi-clock me-1"></i>10.00 - 14.30</span>
                          <span><i class="bi bi-geo-alt me-1"></i>H62</span>
                        </div>
                      </div>
                    </div>

                    <!-- Pengambilan KTM -->
                    <h5 class="fw-semibold text-secondary">
                      Pengambilan Kartu Tanda Mahasiswa
                    </h5>
                    <div class="border rounded p-3">
                      <small class="text-muted d-block mb-2">
                        Para mahasiswa angkatan 2024 yang belum mengambil kartu
                        tanda mahasiswa (KTM), dimohon untuk segera mengambil
                        KTM di Ruang Biro Akademik (BIAK), Gedung G lantai 3.
                        Dan khusus program pascasarjana dapat diambil di ruang
                        TU masing-masing.
                      </small>
                      <small class="text-muted d-block mb-2">Syarat Pengambilan KTM:</small>
                      <ul class="text-muted ps-3 mb-0">
                        <li>
                          Membawa cetak/print e-ticket dari SiAdin mahasiswa.
                        </li>
                        <li>
                          Pengambilan KTM bisa dilakukan mulai tanggal 5
                          Februari 2025 hingga 8 Maret 2025.
                        </li>
                        <li>
                          Pengambilan KTM untuk FIK dilakukan pada Hari Senin,
                          Selasa, & Rabu.
                        </li>
                        <li>
                          Pengambilan KTM untuk FEB, FIB, FKes, FT, & FK
                          dilakukan pada Hari Senin - Jumat.
                        </li>
                        <li>
                          Pengambilan KTM untuk Pascasarjana dilakukan pada Hari
                          Senin - Jumat.
                        </li>
                      </ul>
                    </div>
                  </div>

                  <div class="col-lg-4">
                    <!-- Pengumuman -->
                    <h5 class="fw-semibold text-secondary">Pengumuman</h5>
                    <div class="border rounded p-3">                      
                      <p class="fw-semibold mb-2">Dosen</p>
                      <div class="d-flex justify-content-between align-items-start mb-2">
                        <div>
                          <p class="mb-0 fw-semibold">Grup WA</p>
                          <small class="text-muted">Mata kuliah : Kerja Praktek</small>
                        </div>
                        <button class="btn btn-warning btn-sm ms-3">
                          Lihat detail
                        </button>
                      </div>
                      <div class="d-flex justify-content-between align-items-start">
                        <div>
                          <p class="mb-0 fw-semibold">Pengarahan KP</p>
                          <small class="text-muted">Mata kuliah : Kerja Praktek</small>
                        </div>
                        <button class="btn btn-warning btn-sm ms-3">
                          Lihat detail
                        </button>
                      </div>
                      <div class="d-flex justify-content-end mt-3">
                        <nav>
                          <ul class="pagination pagination-sm mb-0">
                            <li class="page-item">
                              <a class="page-link rounded-3" href="#"><i class="bi bi-chevron-left"></i></a>
                            </li>
                            <li class="page-item">
                              <a class="page-link rounded-3" href="#">1</a>
                            </li>
                            <li class="page-item active">
                              <a class="page-link rounded-3" href="#">2</a>
                            </li>
                            <li class="page-item">
                              <a class="page-link rounded-3" href="#">3</a>
                            </li>
                            <li class="page-item">
                              <a class="page-link rounded-3" href="#"><i class="bi bi-chevron-right"></i></a>
                            </li>
                          </ul>
                        </nav>
                      </div>
                      <hr />
                      <p class="fw-semibold mb-2">Akademik</p>
                      <div class="d-flex justify-content-between align-items-start mb-3">
                        <p class="mb-0 fw-semibold me-3" style="flex: 1">
                          Pengarahan KP, BK, TA Prodi Sarjana TI Genap 24/25
                        </p>
                        <button class="btn btn-warning btn-sm">
                          Lihat detail
                        </button>
                      </div>
                      <div class="d-flex justify-content-between align-items-start mb-3">
                        <p class="mb-0 fw-semibold me-3" style="flex: 1">
                          Pengarahan Tugas Akhir dan Kerja Praktek Prodi STI
                          Genap 24/25
                        </p>
                        <button class="btn btn-warning btn-sm">
                          Lihat detail
                        </button>
                      </div>
                      <div class="d-flex justify-content-between align-items-start mb-3">
                        <p class="mb-0 fw-semibold me-3" style="flex: 1">
                          Pengajuan Perubahan Dosen Pembimbing Tugas Akhir Prodi
                          STI
                        </p>
                        <button class="btn btn-warning btn-sm">
                          Lihat detail
                        </button>
                      </div>
                      <div class="d-flex justify-content-between align-items-start mb-3">
                        <p class="mb-0 fw-semibold me-3" style="flex: 1">
                          Perpanjangan Pendaftaran Sidang TA-2 Gel IV Ganjil
                          24/25 STI
                        </p>
                        <button class="btn btn-warning btn-sm">
                          Lihat detail
                        </button>
                      </div>
                      <div class="d-flex justify-content-between align-items-start">
                        <p class="mb-0 fw-semibold me-3" style="flex: 1">
                          Pendaftaran Sidang TA-2 Gel IV Ganjil 24/25
                        </p>
                        <button class="btn btn-warning btn-sm">
                          Lihat detail
                        </button>
                      </div>
                      <div class="d-flex justify-content-end mt-3">
                        <nav>
                          <ul class="pagination pagination-sm mb-0">
                            <li class="page-item">
                              <a class="page-link rounded-3" href="#"><i class="bi bi-chevron-left"></i></a>
                            </li>
                            <li class="page-item">
                              <a class="page-link rounded-3" href="#">1</a>
                            </li>
                            <li class="page-item active">
                              <a class="page-link rounded-3" href="#">2</a>
                            </li>
                            <li class="page-item">
                              <a class="page-link rounded-3" href="#">3</a>
                            </li>
                            <li class="page-item">
                              <a class="page-link rounded-3" href="#"><i class="bi bi-chevron-right"></i></a>
                            </li>
                          </ul>
                        </nav>
                      </div>
                    </div>
                  </div>
                </div>
              </div>

              <div class="col-lg-3">
                <div class="profile-card text-center mb-4">
                  <img src="/assets/img/profile.png" alt="Foto Profil" class="rounded-circle mb-3" width="100" />
                  <p class="fw-bold mb-0">A11.2022.12345</p>
                  <small class="text-muted">111202212345@mhs.dinus.ac.id</small>
                </div>

                <!-- Kalender Akademik -->
                <h5 class="fw-semibold text-secondary">Kalender akademik</h5>
                <div class="calendar-card p-2">
                  <div class="table-responsive">
                    <table class="table table-bordered text-center align-middle mb-0">
                      <thead class="table-light">
                        <tr>
                          <th>MON</th>
                          <th>TUE</th>
                          <th>WED</th>
                          <th>THU</th>
                          <th>FRI</th>
                          <th>SAT</th>
                          <th>SUN</th>
                        </tr>
                      </thead>
                      <tbody>
                        <tr>
                          <td>29</td>
                          <td>30</td>
                          <td>1</td>
                          <td>2</td>
                          <td>3</td>
                          <td>4</td>
                          <td>5</td>
                        </tr>
                        <tr>
                          <td>6</td>
                          <td>7</td>
                          <td class="border border-primary fw-bold">8</td>
                          <td>9</td>
                          <td>10</td>
                          <td>11</td>
                          <td>12</td>
                        </tr>
                        <tr>
                          <td>13</td>
                          <td>14</td>
                          <td>15</td>
                          <td>16</td>
                          <td>17</td>
                          <td>18</td>
                          <td>19</td>
                        </tr>
                        <tr>
                          <td>20</td>
                          <td>21</td>
                          <td>22</td>
                          <td>23</td>
                          <td>24</td>
                          <td>25</td>
                          <td>26</td>
                        </tr>
                        <tr>
                          <td>27</td>
                          <td>28</td>
                          <td>29</td>
                          <td>30</td>
                          <td>31</td>
                          <td>1</td>
                          <td>2</td>
                        </tr>
                      </tbody>
                    </table>
                  </div>
                </div>
              </div>
            </div>
          </div>
        </div>
      </div>

      <!-- Footer -->
      <div id="footer-container" class="footer-container"></div>
    </div>
  </div>

  <!-- Modal Logout -->
  <div class="modal fade" id="logoutModal" tabindex="-1" aria-labelledby="logoutModalLabel" aria-hidden="true">
    <div class="modal-dialog modal-dialog-centered">
      <div class="modal-content rounded-4 p-3 w-100" style="max-width: 420px">
        <div class="modal-body text-center">
          <h5 id="logoutModalLabel" class="fw-bold">Konfirmasi Keluar</h5>
          <p class="mb-4">Anda yakin ingin keluar?</p>
          <div class="d-flex justify-content-center gap-3 flex-wrap">
            <button type="button" class="btn px-4" id="btn-logout-yes" style="background-color: #1e3a8b; color: white"
              onclick="window.location.href = '../../index.html'">
              Ya
            </button>
            <button type="button" class="btn btn-danger px-4" data-bs-dismiss="modal">
              Tidak
            </button>
          </div>
        </div>
      </div>
    </div>
  </div>

  <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0/dist/js/bootstrap.bundle.min.js"></script>
  <script>
    async function loadComponent(id, path) {
      const res = await fetch(path);
      const html = await res.text();
      document.getElementById(id).innerHTML = html;

      if (id === "sidebar-container" || id === "mobile-sidebar-container") {
        const links = document.querySelectorAll("#" + id + " .nav-link");
        links.forEach((link) => {
          if (link.href === window.location.href) {
            link.classList.add("active", "bg-primary-subtle", "text-primary");
          }
        });
      }

      if (id === "mobile-sidebar-container") {
        const mobileSidebarInstance =
          bootstrap.Offcanvas.getOrCreateInstance("#mobileSidebar");

        const modalEl = document.getElementById("logoutModal");
        if (!modalEl) {
          console.warn("Modal tidak ditemukan di DOM utama!");
          return;
        }

        const logoutModal = new bootstrap.Modal(modalEl, {
          backdrop: "static",
          keyboard: false,
        });

        document
          .querySelector("#mobile-sidebar-container")
          .addEventListener("click", (e) => {
            const btn = e.target.closest("#btn-logout-mobile");
            if (!btn) return;

            e.preventDefault();
            mobileSidebarInstance.hide();

            setTimeout(() => {
              logoutModal.show();
            }, 400);
          });
      }
    }

    function handleBackButton(event) {
      if (window.location.pathname.includes('dashboard.html') ||
        window.location.pathname.endsWith('/dashboard/')) {
        event.preventDefault();

        const logoutModal = new bootstrap.Modal(document.getElementById('logoutModal'));
        logoutModal.show();

        window.history.pushState(null, null, window.location.pathname);
      }
    }

    document.addEventListener('DOMContentLoaded', function () {
      window.history.pushState(null, null, window.location.pathname);

      window.addEventListener('popstate', handleBackButton);

      document.getElementById('btn-logout-yes').addEventListener('click', function () {
        window.location.href = '../../index.html';
      });
    });

    window.addEventListener('beforeunload', function () {
      window.removeEventListener('popstate', handleBackButton);
    });

    loadComponent("header-container", "/header/header.html");
    loadComponent("sidebar-container", "/sidebar/sidebar.html");
    loadComponent("mobile-sidebar-container", "/sidebar/sidebar.html");
    loadComponent("footer-container", "/footer/footer.html");
  </script>
</body>

</html>